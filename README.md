## 📋 Содержание

- [Особенности](#-особенности)
- [Система хранения данных](#-система-хранения-данных)
- [Установка и запуск](#-установка-и-запуск)
- [Тестовые данные](#-тестовые-данные)
- [Функциональность](#-функциональность)
- [Структура проекта](#-структура-проекта)
- [Деплой](#-деплой)
- [API данных](#-api-данных)

## 🎯 Особенности

- **React 18** с TypeScript
- **React Router** для навигации
- **Framer Motion** для плавных анимаций
- **localStorage** для постоянного хранения данных пользователей
- **Трехшаговая регистрация** с подтверждением по коду
- **Трехшаговое восстановление пароля**
- **Адаптивный дизайн** и современный UI

## 💾 Система хранения данных

### Архитектура хранения

```
┌─────────────────────────────────────────────────────────────┐
│                    СИСТЕМА ХРАНЕНИЯ ДАННЫХ                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐    ┌─────────────────┐                │
│  │  ПРЕДУСТАНОВЛЕН │    │   localStorage   │                │
│  │     ДАННЫЕ      │    │  (браузер)      │                │
│  │                 │    │                 │                │
│  │ +998901234567   │    │ Новые           │                │
│  │ +998901234568   │ +  │ пользователи    │  = ИТОГОВАЯ БД │
│  │ +998901234569   │    │                 │                │
│  │ +380635032027   │    │ Обновленные     │                │
│  │                 │    │ пароли          │                │
│  └─────────────────┘    └─────────────────┘                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Где что хранится

#### 1. **Предустановленные пользователи** (неизменяемые)
```javascript
// Файл: src/data/testData.ts
const DEFAULT_USERS = {
  '+998901234567': { phone: '+998901234567', password: 'Test123!', isRegistered: true },
  '+998901234568': { phone: '+998901234568', password: 'Test456!', isRegistered: true },
  '+998901234569': { phone: '+998901234569', password: 'Test789!', isRegistered: true },
  '+380635032027': { phone: '+380635032027', password: 'Ukraine2027!', isRegistered: true }
};
```
- **Где**: В коде приложения (`src/data/testData.ts`)
- **Когда**: Всегда доступны
- **Можно ли изменить**: НЕТ, только через код
- **Сброс**: Невозможен (часть кода)

#### 2. **localStorage** (пользовательские данные)
```javascript
// Ключ в localStorage
const STORAGE_KEY = 'logistics_app_users';

// Структура данных в localStorage
{
  "+380123456789": {
    "phone": "+380123456789",
    "password": "MyNewPass123!",
    "isRegistered": true
  },
  "+7911234567": {
    "phone": "+7911234567", 
    "password": "UpdatedPassword456!",
    "isRegistered": true
  }
}
```
- **Где**: В браузере пользователя
- **Когда**: После регистрации или изменения пароля
- **Можно ли изменить**: ДА, через приложение
- **Сброс**: Возможен (очистка браузера или функция `clearStoredUsers()`)

### Как работает объединение данных

#### При загрузке приложения:
```javascript
// 1. Загружаем из localStorage
const storedUsers = JSON.parse(localStorage.getItem('logistics_app_users') || '{}');

// 2. Объединяем с предустановленными (приоритет у localStorage)
const allUsers = { ...DEFAULT_USERS, ...storedUsers };

// 3. Результат: предустановленные + пользовательские данные
```

#### Приоритет данных:
1. **localStorage** (высший приоритет) - перезаписывает предустановленные
2. **DEFAULT_USERS** (базовый) - используется если нет в localStorage

## 🔄 Жизненный цикл данных

### Регистрация нового пользователя

```
1. Пользователь вводит номер телефона
   ↓
2. Система генерирует код и показывает в консоли
   ↓
3. Пользователь вводит код
   ↓
4. Пользователь создает пароль
   ↓
5. СОХРАНЕНИЕ:
   - Добавляется в globalTestDB.users
   - Сохраняется в localStorage
   ↓
6. Данные доступны навсегда (до очистки браузера)
```

### Восстановление пароля

```
1. Пользователь вводит номер телефона
   ↓
2. Система проверяет существование пользователя
   ↓
3. Генерируется код восстановления
   ↓
4. Пользователь вводит код
   ↓
5. Пользователь устанавливает новый пароль
   ↓
6. ОБНОВЛЕНИЕ:
   - Обновляется в globalTestDB.users
   - Обновляется в localStorage
   ↓
7. Новый пароль работает сразу же
```

### Вход в систему

```
1. Пользователь вводит номер и пароль
   ↓
2. Система проверяет в объединенной базе:
   - Сначала в localStorage
   - Потом в предустановленных данных
   ↓
3. Если найден и пароль совпадает → УСПЕХ
4. Если не найден или пароль неверный → ОШИБКА
```

## 🛠️ Установка и запуск

### Локальная разработка

```bash
# 1. Установите зависимости
npm install

# 2. Запустите локальный сервер
npm start

# 3. Откройте браузер
http://localhost:3000
```

### Production сборка

```bash
# Создать оптимизированную сборку
npm run build

# Деплой на GitHub Pages
npm run deploy
```

## 📱 Тестовые данные

### Предустановленные пользователи (всегда доступны)

| Номер телефона | Пароль | Код для регистрации |
|---------------|---------|-------------------|
| `+998901234567` | `Test123!` | `1234` |
| `+998901234568` | `Test456!` | `5678` |
| `+998901234569` | `Test789!` | `9999` |
| `+380635032027` | `Ukraine2027!` | `2027` |

### Коды подтверждения

- **Предустановленные номера**: фиксированные коды (см. таблицу выше)
- **Новые номера**: случайные 4-значные коды (отображаются в консоли)

## 🎮 Функциональность

### 1. Вход в систему (`/`)
- Проверка номера телефона и пароля
- Поддержка всех пользователей (предустановленные + из localStorage)
- Переход в dashboard при успешном входе

### 2. Регистрация (`/registration`)

#### Шаг 1: Ввод номера телефона
```javascript
// Валидация формата
const phoneRegex = /^\+\d{1,4}\d{7,14}$/;
// Примеры валидных номеров:
// +380XXXXXXXXX (Украина)
// +998XXXXXXXXX (Узбекистан)  
// +7XXXXXXXXXX (Россия)
// +1XXXXXXXXXX (США)
```

#### Шаг 2: Ввод кода подтверждения
```javascript
// Для новых номеров генерируется случайный код
const code = Math.floor(1000 + Math.random() * 9000).toString();
console.log('КОД ДЛЯ РЕГИСТРАЦИИ: ' + code);
```

#### Шаг 3: Создание пароля
```javascript
// Требования к паролю:
- Минимум 6 символов
- Хотя бы одна заглавная буква
- Хотя бы один специальный символ (!@#$%^&*(),.?":{}|<>)
- Подтверждение пароля должно совпадать
```

### 3. Восстановление пароля (`/forgot-password`)

#### Шаг 1: Ввод номера телефона
- Проверяется существование пользователя
- Для существующих пользователей генерируется код

#### Шаг 2: Ввод кода восстановления
- Код действителен 30 секунд
- Возможность повторной отправки кода

#### Шаг 3: Установка нового пароля
- Те же требования что и при регистрации
- Пароль сохраняется в localStorage
- Можно сразу войти с новым паролем

### 4. Dashboard (`/dashboard`)
- Доступен только после успешного входа
- Отображает информацию о пользователе

## 📁 Структура проекта

```
src/
├── components/
│   ├── Header.tsx              # Заголовок с навигацией
│   ├── Footer.tsx              # Подвал страницы
│   ├── Login.tsx               # Страница входа
│   ├── Registration.tsx        # Трехшаговая регистрация
│   ├── ForgotPassword.tsx      # Трехшаговое восстановление пароля
│   ├── Dashboard.tsx           # Главная страница после входа
│   ├── FormMessage.tsx         # Компонент сообщений
│   ├── PasswordToggle.tsx      # Переключатель видимости пароля
│   ├── TransitionOverlay.tsx   # Анимация переходов
│   └── AvailableCodes.tsx      # Отображение доступных кодов
├── data/
│   └── testData.ts             # 🔥 ОСНОВНОЙ ФАЙЛ УПРАВЛЕНИЯ ДАННЫМИ
├── hooks/
│   └── usePasswordToggle.ts    # Хук для переключения видимости пароля
├── css/
│   ├── common.css              # Общие стили
│   ├── login.css               # Стили форм
│   ├── dashboard.css           # Стили dashboard
│   └── cargo-vehicle.css       # Дополнительные стили
├── App.tsx                     # Главный компонент с роутингом
├── App.css                     # Основные стили приложения
└── index.tsx                   # Точка входа
```

## 🚀 Деплой

### GitHub Pages
Приложение автоматически деплоится на GitHub Pages:

**URL**: https://avtnmv.github.io/logistics-react/

```bash
# Ручной деплой
npm run deploy
```

### Локальный деплой
```bash
# Сборка для production
npm run build

# Тестирование production сборки
npx serve -s build
```

## 🔧 API данных

### Основные функции (`src/data/testData.ts`)

#### Получение базы данных
```javascript
import { getGlobalTestDB } from '../data/testData';
const testDB = getGlobalTestDB();
```

#### Проверка пользователя
```javascript
import { verifyUserPassword } from '../data/testData';
const isValid = verifyUserPassword(phone, password, testDB);
```

#### Регистрация пользователя
```javascript
import { registerUser } from '../data/testData';
registerUser(phone, password, testDB, firstName, lastName);
// Автоматически сохраняется в localStorage с именем и фамилией
```

#### Обновление пароля
```javascript
import { updateUserPassword } from '../data/testData';
updateUserPassword(phone, newPassword, testDB);
// Автоматически сохраняется в localStorage
```

#### Очистка данных
```javascript
import { clearStoredUsers, resetTestDB } from '../data/testData';

// Очистить только localStorage
clearStoredUsers();

// Полный сброс к предустановленным данным
resetTestDB();
```

### Структура данных

#### UserData интерфейс
```typescript
interface UserData {
  phone: string;           // Номер телефона
  password: string;        // Пароль пользователя
  isRegistered: boolean;   // Статус регистрации
  firstName?: string;      // Имя пользователя (опционально)
  lastName?: string;       // Фамилия пользователя (опционально)
}
```

#### TestDB интерфейс
```typescript
interface TestDB {
  codes: { [phone: string]: string };              // Коды подтверждения
  users: { [phone: string]: UserData };            // Пользователи
  lastRequestTime: { [phone: string]: number };    // Время последнего запроса
  attempts: { [phone: string]: number };           // Количество попыток
}
```

## 🐛 Отладка и логирование

### Консольные сообщения

#### При загрузке приложения:
```
📱 Загружены данные пользователей из localStorage: ["+380123456789"]
==================================================
                ТЕСТОВЫЕ ДАННЫЕ ДЛЯ ВХОДА
==================================================
📱 +998901234567 → код: 1234
📱 +998901234568 → код: 5678
📱 +998901234569 → код: 9999
📱 +380635032027 → код: 2027
💡 Используйте эти данные для тестирования
```

#### При регистрации:
```
==================================================
                КОД ДЛЯ РЕГИСТРАЦИИ: 7834
==================================================
Номер телефона: +380123456789
Введите этот код для подтверждения: 7834

✅ Пользователь +380123456789 успешно зарегистрирован и сохранен в localStorage
💾 Данные пользователей сохранены в localStorage: ["+380123456789"]
```

#### При восстановлении пароля:
```
==================================================
                КОД ДЛЯ ВОССТАНОВЛЕНИЯ: 5629
==================================================
Номер телефона: +998901234567
Введите этот код для восстановления: 5629

✅ Пароль для +998901234567 успешно изменен и сохранен в localStorage
💾 Данные пользователей сохранены в localStorage: ["+998901234567"]
```

### Проверка localStorage

#### 🎯 Встроенный просмотрщик localStorage
В приложении есть встроенный компонент для просмотра данных:

1. **Откройте приложение** (локально или на GitHub Pages)
2. **Нажмите кнопку "📱 localStorage"** в правом верхнем углу
3. **Просматривайте данные** в удобном интерфейсе:
   - 📞 Номера телефонов
   - 🔒 Пароли
   - 👤 Имена и фамилии
   - ✅ Статусы регистрации

#### Функции встроенного просмотрщика:
- **🔄 Обновить** - перезагрузить данные
- **💾 Экспорт** - скачать данные в JSON файл
- **🗑️ Очистить** - удалить все данные из localStorage

#### В DevTools браузера:
```javascript
// Посмотреть сохраненные данные
localStorage.getItem('logistics_app_users');

// Очистить данные
localStorage.removeItem('logistics_app_users');

// Посмотреть все данные localStorage
console.table(localStorage);

// Красивый вывод пользователей
JSON.parse(localStorage.getItem('logistics_app_users') || '{}');
```

#### Пошаговая инструкция для DevTools:
1. **Откройте DevTools** (F12 или Cmd+Option+I)
2. **Перейдите во вкладку "Application"** (или "Приложение")
3. **В левом меню найдите "Local Storage"**
4. **Выберите ваш домен** (localhost:3000 или avtnmv.github.io)
5. **Найдите ключ "logistics_app_users"**
6. **Кликните на него** - увидите JSON с данными пользователей

## ⚙️ Настройки и конфигурация

### Изменение ключа localStorage
```javascript
// Файл: src/data/testData.ts
const STORAGE_KEY = 'logistics_app_users'; // Измените здесь
```

### Добавление новых предустановленных пользователей
```javascript
// Файл: src/data/testData.ts
const DEFAULT_USERS: { [phone: string]: UserData } = {
  // Существующие пользователи...
  '+1234567890': {
    phone: '+1234567890',
    password: 'NewUser123!',
    isRegistered: true
  }
};

// И добавьте код подтверждения
export const TEST_PHONES: TestPhoneData = {
  // Существующие коды...
  '+1234567890': '0000'
};
```

### Изменение требований к паролю
```javascript
// Файл: src/components/Registration.tsx (строка ~169)
// Файл: src/components/ForgotPassword.tsx (аналогично)

// Минимальная длина
if (password.length < 6) { ... }

// Заглавные буквы
if (!/[A-Z]/.test(password)) { ... }

// Специальные символы
if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) { ... }
```

## 🔒 Безопасность

### Что НЕ безопасно (для production)
- Пароли хранятся в открытом виде в localStorage
- Коды подтверждения показываются в консоли
- Нет шифрования данных
- Нет серверной валидации

### Для production нужно добавить
- Хеширование паролей (bcrypt)
- HTTPS соединение
- Серверную API
- JWT токены
- Реальную отправку SMS
- Валидацию на сервере

## 📊 Производительность

### Размеры
- **Исходный код**: ~150KB
- **Production сборка**: 2.5MB
- **Для пользователей**: ~120KB (gzip)
- **localStorage**: ~1KB на 50 пользователей

### Оптимизации
- Tree shaking (неиспользуемый код удаляется)
- Минификация CSS и JS
- Gzip сжатие
- Lazy loading компонентов (можно добавить)

## 🧪 Тестирование

### Ручное тестирование

#### Сценарий 1: Полный цикл нового пользователя
1. Откройте `/registration`
2. Зарегистрируйте пользователя `+380999888777`
3. Перезагрузите страницу
4. Войдите с новыми данными → ✅ Работает

#### Сценарий 2: Восстановление пароля
1. Откройте `/forgot-password`
2. Восстановите пароль для `+998901234567`
3. Попробуйте войти со старым паролем → ❌ Не работает
4. Войдите с новым паролем → ✅ Работает

#### Сценарий 3: Предустановленные пользователи
1. Очистите localStorage: `localStorage.clear()`
2. Перезагрузите страницу
3. Войдите как `+998901234567` / `Test123!` → ✅ Работает

### Автоматическое тестирование
```bash
# Запуск тестов (если добавлены)
npm test
```

## 🔄 Миграция данных

### Обновление структуры localStorage
Если изменилась структура данных, добавьте миграцию:

```javascript
// Файл: src/data/testData.ts
const loadUsersFromStorage = (): { [phone: string]: UserData } => {
  try {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (stored) {
      const parsed = JSON.parse(stored);
      
      // МИГРАЦИЯ: добавьте новые поля если нужно
      Object.values(parsed).forEach((user: any) => {
        if (!user.hasOwnProperty('newField')) {
          user.newField = 'defaultValue';
        }
      });
      
      return { ...DEFAULT_USERS, ...parsed };
    }
  } catch (error) {
    console.warn('⚠️ Ошибка загрузки, очищаем localStorage:', error);
    localStorage.removeItem(STORAGE_KEY);
  }
  return DEFAULT_USERS;
};
```

## 🆘 Решение проблем

### localStorage не работает
```javascript
// Проверьте поддержку localStorage
if (typeof Storage !== "undefined") {
  console.log("✅ localStorage поддерживается");
} else {
  console.log("❌ localStorage НЕ поддерживается");
}
```

### Данные не сохраняются
1. Откройте DevTools (F12)
2. Application → Local Storage
3. Найдите ключ `logistics_app_users`
4. Если пустой - проверьте консоль на ошибки

### Коды не отображаются в консоли
1. Откройте DevTools (F12) 
2. Вкладка Console
3. Убедитесь что уровень логирования включает `log`

### Не работает вход с новым паролем
1. Проверьте localStorage в DevTools
2. Убедитесь что пароль сохранился
3. Проверьте что нет опечаток в номере телефона

---

## 📞 Поддержка

Если у вас есть вопросы или проблемы:

1. Проверьте консоль браузера на ошибки
2. Убедитесь что localStorage работает
3. Попробуйте очистить localStorage и начать заново
4. Проверьте что используете правильные форматы номеров телефонов

**Приятного использования!** 🚀